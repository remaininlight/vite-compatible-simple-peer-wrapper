{"version":3,"file":"simple-peer-wrapper.mjs","sources":["../../dependencies/vite-compatible-simple-peer/index.js","../../src/simple-peer-client-wrapper.js","../../src/socket-io-client-wrapper.js","../../src/simple-peer-wrapper.js"],"sourcesContent":["/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\nconst debug = require(\"debug\")(\"simple-peer\");\nconst getBrowserRTC = require(\"get-browser-rtc\");\nconst randombytes = require(\"randombytes\");\nconst stream = require(\"vite-compatible-readable-stream\");\nconst queueMicrotask = require(\"queue-microtask\"); // TODO: remove when Node 10 is not supported\nconst errCode = require(\"err-code\");\nconst { Buffer } = require(\"buffer\");\n\nconst MAX_BUFFERED_AMOUNT = 64 * 1024;\nconst ICECOMPLETE_TIMEOUT = 5 * 1000;\nconst CHANNEL_CLOSING_TIMEOUT = 5 * 1000;\n\n// HACK: Filter trickle lines when trickle is disabled #354\nfunction filterTrickle(sdp) {\n  return sdp.replace(/a=ice-options:trickle\\s\\n/g, \"\");\n}\n\nfunction warn(message) {\n  console.warn(message);\n}\n\n/**\n * WebRTC peer connection. Same API as node core `net.Socket`, plus a few extra methods.\n * Duplex stream.\n * @param {Object} opts\n */\nclass Peer extends stream.Duplex {\n  constructor(opts) {\n    opts = Object.assign(\n      {\n        allowHalfOpen: false,\n      },\n      opts\n    );\n\n    super(opts);\n\n    this._id = randombytes(4).toString(\"hex\").slice(0, 7);\n    this._debug(\"new peer %o\", opts);\n\n    this.channelName = opts.initiator\n      ? opts.channelName || randombytes(20).toString(\"hex\")\n      : null;\n\n    this.initiator = opts.initiator || false;\n    this.channelConfig = opts.channelConfig || Peer.channelConfig;\n    this.channelNegotiated = this.channelConfig.negotiated;\n    this.config = Object.assign({}, Peer.config, opts.config);\n    this.offerOptions = opts.offerOptions || {};\n    this.answerOptions = opts.answerOptions || {};\n    this.sdpTransform = opts.sdpTransform || ((sdp) => sdp);\n    this.streams = opts.streams || (opts.stream ? [opts.stream] : []); // support old \"stream\" option\n    this.trickle = opts.trickle !== undefined ? opts.trickle : true;\n    this.allowHalfTrickle =\n      opts.allowHalfTrickle !== undefined ? opts.allowHalfTrickle : false;\n    this.iceCompleteTimeout = opts.iceCompleteTimeout || ICECOMPLETE_TIMEOUT;\n\n    this.destroyed = false;\n    this.destroying = false;\n    this._connected = false;\n\n    this.remoteAddress = undefined;\n    this.remoteFamily = undefined;\n    this.remotePort = undefined;\n    this.localAddress = undefined;\n    this.localFamily = undefined;\n    this.localPort = undefined;\n\n    this._wrtc =\n      opts.wrtc && typeof opts.wrtc === \"object\" ? opts.wrtc : getBrowserRTC();\n\n    if (!this._wrtc) {\n      if (typeof window === \"undefined\") {\n        throw errCode(\n          new Error(\n            \"No WebRTC support: Specify `opts.wrtc` option in this environment\"\n          ),\n          \"ERR_WEBRTC_SUPPORT\"\n        );\n      } else {\n        throw errCode(\n          new Error(\"No WebRTC support: Not a supported browser\"),\n          \"ERR_WEBRTC_SUPPORT\"\n        );\n      }\n    }\n\n    this._pcReady = false;\n    this._channelReady = false;\n    this._iceComplete = false; // ice candidate trickle done (got null candidate)\n    this._iceCompleteTimer = null; // send an offer/answer anyway after some timeout\n    this._channel = null;\n    this._pendingCandidates = [];\n\n    this._isNegotiating = false; // is this peer waiting for negotiation to complete?\n    this._firstNegotiation = true;\n    this._batchedNegotiation = false; // batch synchronous negotiations\n    this._queuedNegotiation = false; // is there a queued negotiation request?\n    this._sendersAwaitingStable = [];\n    this._senderMap = new Map();\n    this._closingInterval = null;\n\n    this._remoteTracks = [];\n    this._remoteStreams = [];\n\n    this._chunk = null;\n    this._cb = null;\n    this._interval = null;\n\n    try {\n      this._pc = new this._wrtc.RTCPeerConnection(this.config);\n    } catch (err) {\n      this.destroy(errCode(err, \"ERR_PC_CONSTRUCTOR\"));\n      return;\n    }\n\n    // We prefer feature detection whenever possible, but sometimes that's not\n    // possible for certain implementations.\n    this._isReactNativeWebrtc = typeof this._pc._peerConnectionId === \"number\";\n\n    this._pc.oniceconnectionstatechange = () => {\n      this._onIceStateChange();\n    };\n    this._pc.onicegatheringstatechange = () => {\n      this._onIceStateChange();\n    };\n    this._pc.onconnectionstatechange = () => {\n      this._onConnectionStateChange();\n    };\n    this._pc.onsignalingstatechange = () => {\n      this._onSignalingStateChange();\n    };\n    this._pc.onicecandidate = (event) => {\n      this._onIceCandidate(event);\n    };\n\n    // HACK: Fix for odd Firefox behavior, see: https://github.com/feross/simple-peer/pull/783\n    if (typeof this._pc.peerIdentity === \"object\") {\n      this._pc.peerIdentity.catch((err) => {\n        this.destroy(errCode(err, \"ERR_PC_PEER_IDENTITY\"));\n      });\n    }\n\n    // Other spec events, unused by this implementation:\n    // - onconnectionstatechange\n    // - onicecandidateerror\n    // - onfingerprintfailure\n    // - onnegotiationneeded\n\n    if (this.initiator || this.channelNegotiated) {\n      this._setupData({\n        channel: this._pc.createDataChannel(\n          this.channelName,\n          this.channelConfig\n        ),\n      });\n    } else {\n      this._pc.ondatachannel = (event) => {\n        this._setupData(event);\n      };\n    }\n\n    if (this.streams) {\n      this.streams.forEach((stream) => {\n        this.addStream(stream);\n      });\n    }\n    this._pc.ontrack = (event) => {\n      this._onTrack(event);\n    };\n\n    this._debug(\"initial negotiation\");\n    this._needsNegotiation();\n\n    this._onFinishBound = () => {\n      this._onFinish();\n    };\n    this.once(\"finish\", this._onFinishBound);\n  }\n\n  get bufferSize() {\n    return (this._channel && this._channel.bufferedAmount) || 0;\n  }\n\n  // HACK: it's possible channel.readyState is \"closing\" before peer.destroy() fires\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=882743\n  get connected() {\n    return this._connected && this._channel.readyState === \"open\";\n  }\n\n  address() {\n    return {\n      port: this.localPort,\n      family: this.localFamily,\n      address: this.localAddress,\n    };\n  }\n\n  signal(data) {\n    if (this.destroying) return;\n    if (this.destroyed)\n      throw errCode(\n        new Error(\"cannot signal after peer is destroyed\"),\n        \"ERR_DESTROYED\"\n      );\n    if (typeof data === \"string\") {\n      try {\n        data = JSON.parse(data);\n      } catch (err) {\n        data = {};\n      }\n    }\n    this._debug(\"signal()\");\n\n    if (data.renegotiate && this.initiator) {\n      this._debug(\"got request to renegotiate\");\n      this._needsNegotiation();\n    }\n    if (data.transceiverRequest && this.initiator) {\n      this._debug(\"got request for transceiver\");\n      this.addTransceiver(\n        data.transceiverRequest.kind,\n        data.transceiverRequest.init\n      );\n    }\n    if (data.candidate) {\n      if (this._pc.remoteDescription && this._pc.remoteDescription.type) {\n        this._addIceCandidate(data.candidate);\n      } else {\n        this._pendingCandidates.push(data.candidate);\n      }\n    }\n    if (data.sdp) {\n      this._pc\n        .setRemoteDescription(new this._wrtc.RTCSessionDescription(data))\n        .then(() => {\n          if (this.destroyed) return;\n\n          this._pendingCandidates.forEach((candidate) => {\n            this._addIceCandidate(candidate);\n          });\n          this._pendingCandidates = [];\n\n          if (this._pc.remoteDescription.type === \"offer\") this._createAnswer();\n        })\n        .catch((err) => {\n          this.destroy(errCode(err, \"ERR_SET_REMOTE_DESCRIPTION\"));\n        });\n    }\n    if (\n      !data.sdp &&\n      !data.candidate &&\n      !data.renegotiate &&\n      !data.transceiverRequest\n    ) {\n      this.destroy(\n        errCode(\n          new Error(\"signal() called with invalid signal data\"),\n          \"ERR_SIGNALING\"\n        )\n      );\n    }\n  }\n\n  _addIceCandidate(candidate) {\n    const iceCandidateObj = new this._wrtc.RTCIceCandidate(candidate);\n    this._pc.addIceCandidate(iceCandidateObj).catch((err) => {\n      if (\n        !iceCandidateObj.address ||\n        iceCandidateObj.address.endsWith(\".local\")\n      ) {\n        warn(\"Ignoring unsupported ICE candidate.\");\n      } else {\n        this.destroy(errCode(err, \"ERR_ADD_ICE_CANDIDATE\"));\n      }\n    });\n  }\n\n  /**\n   * Send text/binary data to the remote peer.\n   * @param {ArrayBufferView|ArrayBuffer|Buffer|string|Blob} chunk\n   */\n  send(chunk) {\n    if (this.destroying) return;\n    if (this.destroyed)\n      throw errCode(\n        new Error(\"cannot send after peer is destroyed\"),\n        \"ERR_DESTROYED\"\n      );\n    this._channel.send(chunk);\n  }\n\n  /**\n   * Add a Transceiver to the connection.\n   * @param {String} kind\n   * @param {Object} init\n   */\n  addTransceiver(kind, init) {\n    if (this.destroying) return;\n    if (this.destroyed)\n      throw errCode(\n        new Error(\"cannot addTransceiver after peer is destroyed\"),\n        \"ERR_DESTROYED\"\n      );\n    this._debug(\"addTransceiver()\");\n\n    if (this.initiator) {\n      try {\n        this._pc.addTransceiver(kind, init);\n        this._needsNegotiation();\n      } catch (err) {\n        this.destroy(errCode(err, \"ERR_ADD_TRANSCEIVER\"));\n      }\n    } else {\n      this.emit(\"signal\", {\n        // request initiator to renegotiate\n        type: \"transceiverRequest\",\n        transceiverRequest: { kind, init },\n      });\n    }\n  }\n\n  /**\n   * Add a MediaStream to the connection.\n   * @param {MediaStream} stream\n   */\n  addStream(stream) {\n    if (this.destroying) return;\n    if (this.destroyed)\n      throw errCode(\n        new Error(\"cannot addStream after peer is destroyed\"),\n        \"ERR_DESTROYED\"\n      );\n    this._debug(\"addStream()\");\n\n    stream.getTracks().forEach((track) => {\n      this.addTrack(track, stream);\n    });\n  }\n\n  /**\n   * Add a MediaStreamTrack to the connection.\n   * @param {MediaStreamTrack} track\n   * @param {MediaStream} stream\n   */\n  addTrack(track, stream) {\n    if (this.destroying) return;\n    if (this.destroyed)\n      throw errCode(\n        new Error(\"cannot addTrack after peer is destroyed\"),\n        \"ERR_DESTROYED\"\n      );\n    this._debug(\"addTrack()\");\n\n    const submap = this._senderMap.get(track) || new Map(); // nested Maps map [track, stream] to sender\n    let sender = submap.get(stream);\n    if (!sender) {\n      sender = this._pc.addTrack(track, stream);\n      submap.set(stream, sender);\n      this._senderMap.set(track, submap);\n      this._needsNegotiation();\n    } else if (sender.removed) {\n      throw errCode(\n        new Error(\n          \"Track has been removed. You should enable/disable tracks that you want to re-add.\"\n        ),\n        \"ERR_SENDER_REMOVED\"\n      );\n    } else {\n      throw errCode(\n        new Error(\"Track has already been added to that stream.\"),\n        \"ERR_SENDER_ALREADY_ADDED\"\n      );\n    }\n  }\n\n  /**\n   * Replace a MediaStreamTrack by another in the connection.\n   * @param {MediaStreamTrack} oldTrack\n   * @param {MediaStreamTrack} newTrack\n   * @param {MediaStream} stream\n   */\n  replaceTrack(oldTrack, newTrack, stream) {\n    if (this.destroying) return;\n    if (this.destroyed)\n      throw errCode(\n        new Error(\"cannot replaceTrack after peer is destroyed\"),\n        \"ERR_DESTROYED\"\n      );\n    this._debug(\"replaceTrack()\");\n\n    const submap = this._senderMap.get(oldTrack);\n    const sender = submap ? submap.get(stream) : null;\n    if (!sender) {\n      throw errCode(\n        new Error(\"Cannot replace track that was never added.\"),\n        \"ERR_TRACK_NOT_ADDED\"\n      );\n    }\n    if (newTrack) this._senderMap.set(newTrack, submap);\n\n    if (sender.replaceTrack != null) {\n      sender.replaceTrack(newTrack);\n    } else {\n      this.destroy(\n        errCode(\n          new Error(\"replaceTrack is not supported in this browser\"),\n          \"ERR_UNSUPPORTED_REPLACETRACK\"\n        )\n      );\n    }\n  }\n\n  /**\n   * Remove a MediaStreamTrack from the connection.\n   * @param {MediaStreamTrack} track\n   * @param {MediaStream} stream\n   */\n  removeTrack(track, stream) {\n    if (this.destroying) return;\n    if (this.destroyed)\n      throw errCode(\n        new Error(\"cannot removeTrack after peer is destroyed\"),\n        \"ERR_DESTROYED\"\n      );\n    this._debug(\"removeSender()\");\n\n    const submap = this._senderMap.get(track);\n    const sender = submap ? submap.get(stream) : null;\n    if (!sender) {\n      throw errCode(\n        new Error(\"Cannot remove track that was never added.\"),\n        \"ERR_TRACK_NOT_ADDED\"\n      );\n    }\n    try {\n      sender.removed = true;\n      this._pc.removeTrack(sender);\n    } catch (err) {\n      if (err.name === \"NS_ERROR_UNEXPECTED\") {\n        this._sendersAwaitingStable.push(sender); // HACK: Firefox must wait until (signalingState === stable) https://bugzilla.mozilla.org/show_bug.cgi?id=1133874\n      } else {\n        this.destroy(errCode(err, \"ERR_REMOVE_TRACK\"));\n      }\n    }\n    this._needsNegotiation();\n  }\n\n  /**\n   * Remove a MediaStream from the connection.\n   * @param {MediaStream} stream\n   */\n  removeStream(stream) {\n    if (this.destroying) return;\n    if (this.destroyed)\n      throw errCode(\n        new Error(\"cannot removeStream after peer is destroyed\"),\n        \"ERR_DESTROYED\"\n      );\n    this._debug(\"removeSenders()\");\n\n    stream.getTracks().forEach((track) => {\n      this.removeTrack(track, stream);\n    });\n  }\n\n  _needsNegotiation() {\n    this._debug(\"_needsNegotiation\");\n    if (this._batchedNegotiation) return; // batch synchronous renegotiations\n    this._batchedNegotiation = true;\n    queueMicrotask(() => {\n      this._batchedNegotiation = false;\n      if (this.initiator || !this._firstNegotiation) {\n        this._debug(\"starting batched negotiation\");\n        this.negotiate();\n      } else {\n        this._debug(\"non-initiator initial negotiation request discarded\");\n      }\n      this._firstNegotiation = false;\n    });\n  }\n\n  negotiate() {\n    if (this.destroying) return;\n    if (this.destroyed)\n      throw errCode(\n        new Error(\"cannot negotiate after peer is destroyed\"),\n        \"ERR_DESTROYED\"\n      );\n\n    if (this.initiator) {\n      if (this._isNegotiating) {\n        this._queuedNegotiation = true;\n        this._debug(\"already negotiating, queueing\");\n      } else {\n        this._debug(\"start negotiation\");\n        setTimeout(() => {\n          // HACK: Chrome crashes if we immediately call createOffer\n          this._createOffer();\n        }, 0);\n      }\n    } else {\n      if (this._isNegotiating) {\n        this._queuedNegotiation = true;\n        this._debug(\"already negotiating, queueing\");\n      } else {\n        this._debug(\"requesting negotiation from initiator\");\n        this.emit(\"signal\", {\n          // request initiator to renegotiate\n          type: \"renegotiate\",\n          renegotiate: true,\n        });\n      }\n    }\n    this._isNegotiating = true;\n  }\n\n  // TODO: Delete this method once readable-stream is updated to contain a default\n  // implementation of destroy() that automatically calls _destroy()\n  // See: https://github.com/nodejs/readable-stream/issues/283\n  destroy(err) {\n    this._destroy(err, () => {});\n  }\n\n  _destroy(err, cb) {\n    if (this.destroyed || this.destroying) return;\n    this.destroying = true;\n\n    this._debug(\"destroying (error: %s)\", err && (err.message || err));\n\n    queueMicrotask(() => {\n      // allow events concurrent with the call to _destroy() to fire (see #692)\n      this.destroyed = true;\n      this.destroying = false;\n\n      this._debug(\"destroy (error: %s)\", err && (err.message || err));\n\n      this.readable = this.writable = false;\n\n      if (!this._readableState.ended) this.push(null);\n      if (!this._writableState.finished) this.end();\n\n      this._connected = false;\n      this._pcReady = false;\n      this._channelReady = false;\n      this._remoteTracks = null;\n      this._remoteStreams = null;\n      this._senderMap = null;\n\n      clearInterval(this._closingInterval);\n      this._closingInterval = null;\n\n      clearInterval(this._interval);\n      this._interval = null;\n      this._chunk = null;\n      this._cb = null;\n\n      if (this._onFinishBound)\n        this.removeListener(\"finish\", this._onFinishBound);\n      this._onFinishBound = null;\n\n      if (this._channel) {\n        try {\n          this._channel.close();\n        } catch (err) {}\n\n        // allow events concurrent with destruction to be handled\n        this._channel.onmessage = null;\n        this._channel.onopen = null;\n        this._channel.onclose = null;\n        this._channel.onerror = null;\n      }\n      if (this._pc) {\n        try {\n          this._pc.close();\n        } catch (err) {}\n\n        // allow events concurrent with destruction to be handled\n        this._pc.oniceconnectionstatechange = null;\n        this._pc.onicegatheringstatechange = null;\n        this._pc.onsignalingstatechange = null;\n        this._pc.onicecandidate = null;\n        this._pc.ontrack = null;\n        this._pc.ondatachannel = null;\n      }\n      this._pc = null;\n      this._channel = null;\n\n      if (err) this.emit(\"error\", err);\n      this.emit(\"close\");\n      cb();\n    });\n  }\n\n  _setupData(event) {\n    if (!event.channel) {\n      // In some situations `pc.createDataChannel()` returns `undefined` (in wrtc),\n      // which is invalid behavior. Handle it gracefully.\n      // See: https://github.com/feross/simple-peer/issues/163\n      return this.destroy(\n        errCode(\n          new Error(\"Data channel event is missing `channel` property\"),\n          \"ERR_DATA_CHANNEL\"\n        )\n      );\n    }\n\n    this._channel = event.channel;\n    this._channel.binaryType = \"arraybuffer\";\n\n    if (typeof this._channel.bufferedAmountLowThreshold === \"number\") {\n      this._channel.bufferedAmountLowThreshold = MAX_BUFFERED_AMOUNT;\n    }\n\n    this.channelName = this._channel.label;\n\n    this._channel.onmessage = (event) => {\n      this._onChannelMessage(event);\n    };\n    this._channel.onbufferedamountlow = () => {\n      this._onChannelBufferedAmountLow();\n    };\n    this._channel.onopen = () => {\n      this._onChannelOpen();\n    };\n    this._channel.onclose = () => {\n      this._onChannelClose();\n    };\n    this._channel.onerror = (event) => {\n      const err =\n        event.error instanceof Error\n          ? event.error\n          : new Error(\n              `Datachannel error: ${event.message} ${event.filename}:${event.lineno}:${event.colno}`\n            );\n      this.destroy(errCode(err, \"ERR_DATA_CHANNEL\"));\n    };\n\n    // HACK: Chrome will sometimes get stuck in readyState \"closing\", let's check for this condition\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=882743\n    let isClosing = false;\n    this._closingInterval = setInterval(() => {\n      // No \"onclosing\" event\n      if (this._channel && this._channel.readyState === \"closing\") {\n        if (isClosing) this._onChannelClose(); // closing timed out: equivalent to onclose firing\n        isClosing = true;\n      } else {\n        isClosing = false;\n      }\n    }, CHANNEL_CLOSING_TIMEOUT);\n  }\n\n  _read() {}\n\n  _write(chunk, encoding, cb) {\n    if (this.destroyed)\n      return cb(\n        errCode(\n          new Error(\"cannot write after peer is destroyed\"),\n          \"ERR_DATA_CHANNEL\"\n        )\n      );\n\n    if (this._connected) {\n      try {\n        this.send(chunk);\n      } catch (err) {\n        return this.destroy(errCode(err, \"ERR_DATA_CHANNEL\"));\n      }\n      if (this._channel.bufferedAmount > MAX_BUFFERED_AMOUNT) {\n        this._debug(\n          \"start backpressure: bufferedAmount %d\",\n          this._channel.bufferedAmount\n        );\n        this._cb = cb;\n      } else {\n        cb(null);\n      }\n    } else {\n      this._debug(\"write before connect\");\n      this._chunk = chunk;\n      this._cb = cb;\n    }\n  }\n\n  // When stream finishes writing, close socket. Half open connections are not\n  // supported.\n  _onFinish() {\n    if (this.destroyed) return;\n\n    // Wait a bit before destroying so the socket flushes.\n    // TODO: is there a more reliable way to accomplish this?\n    const destroySoon = () => {\n      setTimeout(() => this.destroy(), 1000);\n    };\n\n    if (this._connected) {\n      destroySoon();\n    } else {\n      this.once(\"connect\", destroySoon);\n    }\n  }\n\n  _startIceCompleteTimeout() {\n    if (this.destroyed) return;\n    if (this._iceCompleteTimer) return;\n    this._debug(\"started iceComplete timeout\");\n    this._iceCompleteTimer = setTimeout(() => {\n      if (!this._iceComplete) {\n        this._iceComplete = true;\n        this._debug(\"iceComplete timeout completed\");\n        this.emit(\"iceTimeout\");\n        this.emit(\"_iceComplete\");\n      }\n    }, this.iceCompleteTimeout);\n  }\n\n  _createOffer() {\n    if (this.destroyed) return;\n\n    this._pc\n      .createOffer(this.offerOptions)\n      .then((offer) => {\n        if (this.destroyed) return;\n        if (!this.trickle && !this.allowHalfTrickle)\n          offer.sdp = filterTrickle(offer.sdp);\n        offer.sdp = this.sdpTransform(offer.sdp);\n\n        const sendOffer = () => {\n          if (this.destroyed) return;\n          const signal = this._pc.localDescription || offer;\n          this._debug(\"signal\");\n          this.emit(\"signal\", {\n            type: signal.type,\n            sdp: signal.sdp,\n          });\n        };\n\n        const onSuccess = () => {\n          this._debug(\"createOffer success\");\n          if (this.destroyed) return;\n          if (this.trickle || this._iceComplete) sendOffer();\n          else this.once(\"_iceComplete\", sendOffer); // wait for candidates\n        };\n\n        const onError = (err) => {\n          this.destroy(errCode(err, \"ERR_SET_LOCAL_DESCRIPTION\"));\n        };\n\n        this._pc.setLocalDescription(offer).then(onSuccess).catch(onError);\n      })\n      .catch((err) => {\n        this.destroy(errCode(err, \"ERR_CREATE_OFFER\"));\n      });\n  }\n\n  _requestMissingTransceivers() {\n    if (this._pc.getTransceivers) {\n      this._pc.getTransceivers().forEach((transceiver) => {\n        if (\n          !transceiver.mid &&\n          transceiver.sender.track &&\n          !transceiver.requested\n        ) {\n          transceiver.requested = true; // HACK: Safari returns negotiated transceivers with a null mid\n          this.addTransceiver(transceiver.sender.track.kind);\n        }\n      });\n    }\n  }\n\n  _createAnswer() {\n    if (this.destroyed) return;\n\n    this._pc\n      .createAnswer(this.answerOptions)\n      .then((answer) => {\n        if (this.destroyed) return;\n        if (!this.trickle && !this.allowHalfTrickle)\n          answer.sdp = filterTrickle(answer.sdp);\n        answer.sdp = this.sdpTransform(answer.sdp);\n\n        const sendAnswer = () => {\n          if (this.destroyed) return;\n          const signal = this._pc.localDescription || answer;\n          this._debug(\"signal\");\n          this.emit(\"signal\", {\n            type: signal.type,\n            sdp: signal.sdp,\n          });\n          if (!this.initiator) this._requestMissingTransceivers();\n        };\n\n        const onSuccess = () => {\n          if (this.destroyed) return;\n          if (this.trickle || this._iceComplete) sendAnswer();\n          else this.once(\"_iceComplete\", sendAnswer);\n        };\n\n        const onError = (err) => {\n          this.destroy(errCode(err, \"ERR_SET_LOCAL_DESCRIPTION\"));\n        };\n\n        this._pc.setLocalDescription(answer).then(onSuccess).catch(onError);\n      })\n      .catch((err) => {\n        this.destroy(errCode(err, \"ERR_CREATE_ANSWER\"));\n      });\n  }\n\n  _onConnectionStateChange() {\n    if (this.destroyed) return;\n    if (this._pc.connectionState === \"failed\") {\n      this.destroy(\n        errCode(new Error(\"Connection failed.\"), \"ERR_CONNECTION_FAILURE\")\n      );\n    }\n  }\n\n  _onIceStateChange() {\n    if (this.destroyed) return;\n    const iceConnectionState = this._pc.iceConnectionState;\n    const iceGatheringState = this._pc.iceGatheringState;\n\n    this._debug(\n      \"iceStateChange (connection: %s) (gathering: %s)\",\n      iceConnectionState,\n      iceGatheringState\n    );\n    this.emit(\"iceStateChange\", iceConnectionState, iceGatheringState);\n\n    if (\n      iceConnectionState === \"connected\" ||\n      iceConnectionState === \"completed\"\n    ) {\n      this._pcReady = true;\n      this._maybeReady();\n    }\n    if (iceConnectionState === \"failed\") {\n      this.destroy(\n        errCode(\n          new Error(\"Ice connection failed.\"),\n          \"ERR_ICE_CONNECTION_FAILURE\"\n        )\n      );\n    }\n    if (iceConnectionState === \"closed\") {\n      this.destroy(\n        errCode(\n          new Error(\"Ice connection closed.\"),\n          \"ERR_ICE_CONNECTION_CLOSED\"\n        )\n      );\n    }\n  }\n\n  getStats(cb) {\n    // statreports can come with a value array instead of properties\n    const flattenValues = (report) => {\n      if (Object.prototype.toString.call(report.values) === \"[object Array]\") {\n        report.values.forEach((value) => {\n          Object.assign(report, value);\n        });\n      }\n      return report;\n    };\n\n    // Promise-based getStats() (standard)\n    if (this._pc.getStats.length === 0 || this._isReactNativeWebrtc) {\n      this._pc.getStats().then(\n        (res) => {\n          const reports = [];\n          res.forEach((report) => {\n            reports.push(flattenValues(report));\n          });\n          cb(null, reports);\n        },\n        (err) => cb(err)\n      );\n\n      // Single-parameter callback-based getStats() (non-standard)\n    } else if (this._pc.getStats.length > 0) {\n      this._pc.getStats(\n        (res) => {\n          // If we destroy connection in `connect` callback this code might happen to run when actual connection is already closed\n          if (this.destroyed) return;\n\n          const reports = [];\n          res.result().forEach((result) => {\n            const report = {};\n            result.names().forEach((name) => {\n              report[name] = result.stat(name);\n            });\n            report.id = result.id;\n            report.type = result.type;\n            report.timestamp = result.timestamp;\n            reports.push(flattenValues(report));\n          });\n          cb(null, reports);\n        },\n        (err) => cb(err)\n      );\n\n      // Unknown browser, skip getStats() since it's anyone's guess which style of\n      // getStats() they implement.\n    } else {\n      cb(null, []);\n    }\n  }\n\n  _maybeReady() {\n    this._debug(\n      \"maybeReady pc %s channel %s\",\n      this._pcReady,\n      this._channelReady\n    );\n    if (\n      this._connected ||\n      this._connecting ||\n      !this._pcReady ||\n      !this._channelReady\n    )\n      return;\n\n    this._connecting = true;\n\n    // HACK: We can't rely on order here, for details see https://github.com/js-platform/node-webrtc/issues/339\n    const findCandidatePair = () => {\n      if (this.destroyed) return;\n\n      this.getStats((err, items) => {\n        if (this.destroyed) return;\n\n        // Treat getStats error as non-fatal. It's not essential.\n        if (err) items = [];\n\n        const remoteCandidates = {};\n        const localCandidates = {};\n        const candidatePairs = {};\n        let foundSelectedCandidatePair = false;\n\n        items.forEach((item) => {\n          // TODO: Once all browsers support the hyphenated stats report types, remove\n          // the non-hypenated ones\n          if (\n            item.type === \"remotecandidate\" ||\n            item.type === \"remote-candidate\"\n          ) {\n            remoteCandidates[item.id] = item;\n          }\n          if (\n            item.type === \"localcandidate\" ||\n            item.type === \"local-candidate\"\n          ) {\n            localCandidates[item.id] = item;\n          }\n          if (item.type === \"candidatepair\" || item.type === \"candidate-pair\") {\n            candidatePairs[item.id] = item;\n          }\n        });\n\n        const setSelectedCandidatePair = (selectedCandidatePair) => {\n          foundSelectedCandidatePair = true;\n\n          let local = localCandidates[selectedCandidatePair.localCandidateId];\n\n          if (local && (local.ip || local.address)) {\n            // Spec\n            this.localAddress = local.ip || local.address;\n            this.localPort = Number(local.port);\n          } else if (local && local.ipAddress) {\n            // Firefox\n            this.localAddress = local.ipAddress;\n            this.localPort = Number(local.portNumber);\n          } else if (\n            typeof selectedCandidatePair.googLocalAddress === \"string\"\n          ) {\n            // TODO: remove this once Chrome 58 is released\n            local = selectedCandidatePair.googLocalAddress.split(\":\");\n            this.localAddress = local[0];\n            this.localPort = Number(local[1]);\n          }\n          if (this.localAddress) {\n            this.localFamily = this.localAddress.includes(\":\")\n              ? \"IPv6\"\n              : \"IPv4\";\n          }\n\n          let remote =\n            remoteCandidates[selectedCandidatePair.remoteCandidateId];\n\n          if (remote && (remote.ip || remote.address)) {\n            // Spec\n            this.remoteAddress = remote.ip || remote.address;\n            this.remotePort = Number(remote.port);\n          } else if (remote && remote.ipAddress) {\n            // Firefox\n            this.remoteAddress = remote.ipAddress;\n            this.remotePort = Number(remote.portNumber);\n          } else if (\n            typeof selectedCandidatePair.googRemoteAddress === \"string\"\n          ) {\n            // TODO: remove this once Chrome 58 is released\n            remote = selectedCandidatePair.googRemoteAddress.split(\":\");\n            this.remoteAddress = remote[0];\n            this.remotePort = Number(remote[1]);\n          }\n          if (this.remoteAddress) {\n            this.remoteFamily = this.remoteAddress.includes(\":\")\n              ? \"IPv6\"\n              : \"IPv4\";\n          }\n\n          this._debug(\n            \"connect local: %s:%s remote: %s:%s\",\n            this.localAddress,\n            this.localPort,\n            this.remoteAddress,\n            this.remotePort\n          );\n        };\n\n        items.forEach((item) => {\n          // Spec-compliant\n          if (item.type === \"transport\" && item.selectedCandidatePairId) {\n            setSelectedCandidatePair(\n              candidatePairs[item.selectedCandidatePairId]\n            );\n          }\n\n          // Old implementations\n          if (\n            (item.type === \"googCandidatePair\" &&\n              item.googActiveConnection === \"true\") ||\n            ((item.type === \"candidatepair\" ||\n              item.type === \"candidate-pair\") &&\n              item.selected)\n          ) {\n            setSelectedCandidatePair(item);\n          }\n        });\n\n        // Ignore candidate pair selection in browsers like Safari 11 that do not have any local or remote candidates\n        // But wait until at least 1 candidate pair is available\n        if (\n          !foundSelectedCandidatePair &&\n          (!Object.keys(candidatePairs).length ||\n            Object.keys(localCandidates).length)\n        ) {\n          setTimeout(findCandidatePair, 100);\n          return;\n        } else {\n          this._connecting = false;\n          this._connected = true;\n        }\n\n        if (this._chunk) {\n          try {\n            this.send(this._chunk);\n          } catch (err) {\n            return this.destroy(errCode(err, \"ERR_DATA_CHANNEL\"));\n          }\n          this._chunk = null;\n          this._debug('sent chunk from \"write before connect\"');\n\n          const cb = this._cb;\n          this._cb = null;\n          cb(null);\n        }\n\n        // If `bufferedAmountLowThreshold` and 'onbufferedamountlow' are unsupported,\n        // fallback to using setInterval to implement backpressure.\n        if (typeof this._channel.bufferedAmountLowThreshold !== \"number\") {\n          this._interval = setInterval(() => this._onInterval(), 150);\n          if (this._interval.unref) this._interval.unref();\n        }\n\n        this._debug(\"connect\");\n        this.emit(\"connect\");\n      });\n    };\n    findCandidatePair();\n  }\n\n  _onInterval() {\n    if (\n      !this._cb ||\n      !this._channel ||\n      this._channel.bufferedAmount > MAX_BUFFERED_AMOUNT\n    ) {\n      return;\n    }\n    this._onChannelBufferedAmountLow();\n  }\n\n  _onSignalingStateChange() {\n    if (this.destroyed) return;\n\n    if (this._pc.signalingState === \"stable\") {\n      this._isNegotiating = false;\n\n      // HACK: Firefox doesn't yet support removing tracks when signalingState !== 'stable'\n      this._debug(\"flushing sender queue\", this._sendersAwaitingStable);\n      this._sendersAwaitingStable.forEach((sender) => {\n        this._pc.removeTrack(sender);\n        this._queuedNegotiation = true;\n      });\n      this._sendersAwaitingStable = [];\n\n      if (this._queuedNegotiation) {\n        this._debug(\"flushing negotiation queue\");\n        this._queuedNegotiation = false;\n        this._needsNegotiation(); // negotiate again\n      } else {\n        this._debug(\"negotiated\");\n        this.emit(\"negotiated\");\n      }\n    }\n\n    this._debug(\"signalingStateChange %s\", this._pc.signalingState);\n    this.emit(\"signalingStateChange\", this._pc.signalingState);\n  }\n\n  _onIceCandidate(event) {\n    if (this.destroyed) return;\n    if (event.candidate && this.trickle) {\n      this.emit(\"signal\", {\n        type: \"candidate\",\n        candidate: {\n          candidate: event.candidate.candidate,\n          sdpMLineIndex: event.candidate.sdpMLineIndex,\n          sdpMid: event.candidate.sdpMid,\n        },\n      });\n    } else if (!event.candidate && !this._iceComplete) {\n      this._iceComplete = true;\n      this.emit(\"_iceComplete\");\n    }\n    // as soon as we've received one valid candidate start timeout\n    if (event.candidate) {\n      this._startIceCompleteTimeout();\n    }\n  }\n\n  _onChannelMessage(event) {\n    if (this.destroyed) return;\n    let data = event.data;\n    if (data instanceof ArrayBuffer) data = Buffer.from(data);\n    this.push(data);\n  }\n\n  _onChannelBufferedAmountLow() {\n    if (this.destroyed || !this._cb) return;\n    this._debug(\n      \"ending backpressure: bufferedAmount %d\",\n      this._channel.bufferedAmount\n    );\n    const cb = this._cb;\n    this._cb = null;\n    cb(null);\n  }\n\n  _onChannelOpen() {\n    if (this._connected || this.destroyed) return;\n    this._debug(\"on channel open\");\n    this._channelReady = true;\n    this._maybeReady();\n  }\n\n  _onChannelClose() {\n    if (this.destroyed) return;\n    this._debug(\"on channel close\");\n    this.destroy();\n  }\n\n  _onTrack(event) {\n    if (this.destroyed) return;\n\n    event.streams.forEach((eventStream) => {\n      this._debug(\"on track\");\n      this.emit(\"track\", event.track, eventStream);\n\n      this._remoteTracks.push({\n        track: event.track,\n        stream: eventStream,\n      });\n\n      if (\n        this._remoteStreams.some((remoteStream) => {\n          return remoteStream.id === eventStream.id;\n        })\n      )\n        return; // Only fire one 'stream' event, even though there may be multiple tracks per stream\n\n      this._remoteStreams.push(eventStream);\n      queueMicrotask(() => {\n        this._debug(\"on stream\");\n        this.emit(\"stream\", eventStream); // ensure all tracks have been added\n      });\n    });\n  }\n\n  _debug() {\n    const args = [].slice.call(arguments);\n    args[0] = \"[\" + this._id + \"] \" + args[0];\n    debug.apply(null, args);\n  }\n}\n\nPeer.WEBRTC_SUPPORT = !!getBrowserRTC();\n\n/**\n * Expose peer and data channel config for overriding all Peer\n * instances. Otherwise, just set opts.config or opts.channelConfig\n * when constructing a Peer.\n */\nPeer.config = {\n  iceServers: [\n    {\n      urls: [\n        \"stun:stun.l.google.com:19302\",\n        \"stun:global.stun.twilio.com:3478\",\n      ],\n    },\n  ],\n  sdpSemantics: \"unified-plan\",\n};\n\nPeer.channelConfig = {};\n\n//module.exports = Peer;\nexport { Peer }\n","import { Peer } from '../dependencies/vite-compatible-simple-peer/index.js'\n//const Peer = require('vite-compatible-simple-peer');\n\nclass SimplePeerClientWrapper {\n  constructor(socket, debug, simplePeerOptions) {\n    this.initPeerRequest = false;\n    this.socket = socket;\n    this.localStream;\n    this.debug = debug;\n    this.connections = [];\n    this.onDataCallback;\n    this.onStreamCallback;\n    // this.onTrackCallback;\n    this.onCloseCallback;\n    this.onErrorCallback;\n    this.simplePeerOptions = simplePeerOptions;\n  }\n\n  setlocalStream(stream) {\n    this.localStream = stream;\n  }\n\n  init() {\n    this.debug &&\n      console.log(\n        'running init Peer Client. # of ' + this.connections.length,\n      );\n    this.initPeerRequest = true;\n\n    for (let i = 0; i < this.connections.length; i++) {\n      this.socket.emit('initiate peer', this.connections[i].room);\n      if (this.connections[i].initiator) {\n        this.attemptPeerStart(this.connections[i]);\n      }\n    }\n  }\n\n  attemptPeerStart(connection) {\n    this.debug &&\n      console.log(\n        'Attempting peer start',\n        connection.peerStarted,\n        connection.roomReady,\n      );\n\n    if (!connection.peerStarted && connection.roomReady) {\n      this.debug && console.log('Creating peer connection');\n      this.createPeerConnection(connection);\n    } else {\n      this.debug && console.log('Not creating peer connection');\n    }\n  }\n\n  createPeerConnection(connection) {\n    this.debug && console.log('creating simple peer');\n\n    const options = this._getPeerOptions(connection.initiator);\n    const peer = new Peer(options);\n\n    // If initiator,peer.on'signal' will fire right away, if not it waits for signal\n    // https://github.com/feross/simple-peer#peeronsignal-data--\n    peer.on('signal', (data) => this._sendSignal(data, connection));\n    peer.on('connect', (data) => this._handleConnection(data));\n    peer.on('error', (err) => this._handleError(err));\n    peer.on('stream', (stream) => this._handleStream(stream));\n    peer.on('data', (data) => this._handleData(data));\n    // peer.on('track', (track, stream) =>\n    //   this._handleTrack(track, stream),\n    // );\n    peer.on('close', () => this._handleClose());\n\n    connection.peerStarted = true;\n    connection.peer = peer;\n  }\n\n  isPeerStarted() {\n    let peerStarted = false;\n\n    // if any peer connection is not started then it returns false\n    for (let i = 0; i < this.connections.length; i++) {\n      peerStarted = this.connections[i].peerStarted;\n    }\n    return peerStarted;\n  }\n\n  setEventCallback(event, callback) {\n    switch (event) {\n      case 'data':\n        this.onDataCallback = callback;\n        break;\n      case 'stream':\n        this.onStreamCallback = callback;\n        break;\n      // case 'track':\n      //   this.onTrackCallback = callback;\n      //   break;\n      case 'close':\n        this.onCloseCallback = callback;\n        break;\n      case 'error':\n        this.onErrorCallback = callback;\n    }\n  }\n\n  sendData(data) {\n    let msg = JSON.stringify({ data: data, userId: this.socket.id });\n    for (let i = 0; i < this.connections.length; i++) {\n      const peer = this.connections[i];\n      if (peer.peerStarted) {\n        const peerConn = peer.peer;\n        if (peerConn.connected) {\n          peerConn.write(msg);\n        }\n      }\n    }\n  }\n\n  terminateSession() {\n    for (let i = 0; i < this.connections.length; i++) {\n      const peer = this.connections[i].peer;\n      peer.destroy(); // simple-peer method to close and cleanup peer connection\n      this.connections[i].peer = null;\n      this.connections[i].peerStarted = false;\n    }\n\n    this.socket.emit('hangup');\n    this.socket.close();\n  }\n\n  _getPeerOptions(initiator) {\n    const options = {\n      initiator: initiator,\n    };\n\n    if (typeof this.localStream !== 'undefined') {\n      options.stream = this.localStream;\n    }\n\n    const spOptions = Object.entries(this.simplePeerOptions);\n\n    if (spOptions.length > 0) {\n      for (const [key, value] of spOptions) {\n        options[key] = value;\n      }\n    }\n\n    return options;\n  }\n\n  _sendSignal(data, connection) {\n    this.debug && console.log('sending signal');\n\n    const message = {\n      room: connection.room,\n      data: JSON.stringify(data),\n    };\n\n    this.socket.emit('sending signal', message);\n  }\n\n  _handleConnection(data) {\n    console.log('SIMPLE PEER IS CONNECTED');\n  }\n\n  _handleStream(stream) {\n    this.onStreamCallback(stream);\n  }\n\n  _handleError(err) {\n    if (typeof this.onErrorCallback !== 'undefined') {\n      this.onErrorCallback(err);\n    } else {\n      console.log(err);\n    }\n  }\n\n  _handleData(data) {\n    const decodedString = new TextDecoder('utf-8').decode(data);\n    const decodedJSON = JSON.parse(decodedString);\n    this.onDataCallback(decodedJSON);\n  }\n\n  _handleClose() {\n    if (typeof this.onCloseCallback !== 'undefined') {\n      this.onCloseCallback();\n    }\n\n    this.debug && console.log('Closing Connection');\n  }\n\n  _handleRemoteHangup() {\n    this.debug && console.log('Handling remote hangup');\n    this.terminateSession(true);\n  }\n\n  _closePeerConnection() {\n    // peerStarted = false;\n    // peer.destroy();\n    // peer = null;\n  }\n}\n\nexport { SimplePeerClientWrapper }\n//module.exports = SimplePeerClientWrapper;\n","//import { io } from \"socket.io-client\";\n//import io from 'socket.io-client'\nconst io = require('socket.io-client');\n//const SimplePeerClientWrapper = require('./simple-peer-client-wrapper.js');\nimport { SimplePeerClientWrapper } from './simple-peer-client-wrapper.js';\n\nclass SocketIOClientWrapper {\n  constructor({\n    stream,\n    serverUrl,\n    debug = false,\n    simplePeerOptions = {},\n  } = {}) {\n    this.debug = debug;\n\n    if (typeof serverUrl === 'undefined') {\n      console.error(\n        'simple-peer-wrapper requires that you specify a serverUrl on startup. Please specify a serverUrl and try again. See documentation for more information https://github.com/lisajamhoury/simple-peer-wrapper',\n      );\n    }\n\n    this.debug && console.log('connecting socket to ' + serverUrl);\n    this.socket = io.connect(serverUrl);\n\n    this.peerClient = new SimplePeerClientWrapper(\n      this.socket,\n      this.debug,\n      simplePeerOptions,\n    );\n\n    if (typeof stream !== 'undefined') {\n      this.peerClient.setlocalStream(stream);\n    }\n\n    this._initSocket();\n  }\n\n  _initSocket() {\n    this.socket.on('created', (room) => this._handleCreated(room));\n    this.socket.on('full', (room) => this._handleFullRoom(room));\n    this.socket.on('join', (room) => this._handleJoinRoom(room));\n    this.socket.on('joined', (room) => this._handleJoinedRoom(room));\n    this.socket.on('initiate peer', (room) =>\n      this._handleInitPeer(room),\n    );\n    this.socket.on('sending signal', (message) =>\n      this._handleSendSignal(message),\n    );\n    this.socket.on('log', (array) => this._handleLog(array));\n    this.socket.on('message', (message) =>\n      this._handleMessage(message),\n    );\n\n    this._startSocketCommunication();\n  }\n\n  // starts socket client communication with signal server automatically\n  _startSocketCommunication() {\n    this.socket.emit('create or join');\n    this.debug && console.log('Attempted to create or join room');\n  }\n\n  _handleCreated(room) {\n    this.debug && console.log('Created room ' + room);\n  }\n\n  // room only holds two clients, can be changed in signal_socket.js\n  _handleFullRoom(room) {\n    this.debug && console.log('Room ' + room + ' is full');\n  }\n\n  // called by initiator client only\n  _handleJoinRoom(room) {\n    this.debug &&\n      console.log('Another peer made a request to join room ' + room);\n    this.debug &&\n      console.log('This peer is the initiator of room ' + room + '!');\n\n    this._logConnection(room, true, true, false);\n    if (this.peerClient.initPeerRequest) {\n      this.debug && console.log('initing peer from handle join');\n      this.peerClient.init();\n    }\n  }\n\n  // called by non-initiator client\n  _handleJoinedRoom(room) {\n    this.debug && console.log('joined: ' + room);\n\n    this._logConnection(room, false, true, false);\n    if (this.peerClient.initPeerRequest) {\n      this.debug && console.log('initing peer from handle joined');\n      this.peerClient.init();\n    }\n  }\n\n  _logConnection(_room, _initiator, _roomReady, _peerStarted) {\n    this.debug && console.log('logging connection');\n    const newConnection = {\n      room: _room, // socket.io server room\n      initiator: _initiator, // client initiates the communication\n      roomReady: _roomReady, // socket.io room is created or joined\n      peerStarted: _peerStarted, // the peer connection is started\n    };\n\n    this.peerClient.connections.push(newConnection);\n  }\n\n  // logs messages from server\n  _handleLog(array) {\n    log.apply(console, array);\n  }\n\n  _handleInitPeer(room) {\n    const connection = this._findConnection(room);\n    this.peerClient.attemptPeerStart(connection);\n  }\n\n  _handleSendSignal(message) {\n    this.debug && console.log('receiving simple signal data');\n    const connection = this._findConnection(message.room);\n\n    if (!connection.peerStarted) {\n      this.debug && console.log('Creating peer from messages!');\n      this.peerClient.createPeerConnection(connection);\n      connection.peer.signal(message.data);\n    } else {\n      connection.peer.signal(message.data);\n    }\n  }\n\n  _findConnection(room) {\n    let connection = null;\n\n    for (let i = 0; i < this.peerClient.connections.length; i++) {\n      if (this.peerClient.connections[i].room === room) {\n        connection = this.peerClient.connections[i];\n      }\n    }\n\n    if (connection === null) {\n      this.debug && console.log('UT OH THAT CONNECTION DOESNT EXIST');\n    } else {\n      this.debug &&\n        console.log('found the connection for room: ' + room);\n    }\n\n    return connection;\n  }\n\n  // This client receives a message\n  _handleMessage(message) {\n    this.debug && console.log('MESSAGE ' + message);\n\n    if (message.type) {\n      this.debug && console.log('received msg typ ' + message.type);\n    } else {\n      this.debug &&\n        console.log('Client received message: ' + message);\n    }\n\n    // TO DO HANDLE BYE\n    // } else if (message === 'bye' && peerStarted) {\n    //   handleRemoteHangup();\n  }\n\n  _emitSocketMessage(message) {\n    this.debug && console.log('Client sending message: ', message);\n    this.socket.emit('message', message);\n  }\n}\n\nexport { SocketIOClientWrapper }\n//module.exports = SocketIOClientWrapper;\n","//const SocketIOClientWrapper = require('./socket-io-client-wrapper.js');\nimport { SocketIOClientWrapper } from './socket-io-client-wrapper.js'\n\nclass SimplePeerWrapper {\n  constructor(options) {\n    this.socketClient = new SocketIOClientWrapper(options);\n    this.peerClient = this.socketClient.peerClient;\n  }\n\n  connect() {\n    this.peerClient.init();\n  }\n\n  isConnectionStarted() {\n    return this.peerClient.isPeerStarted();\n  }\n\n  send(data) {\n    this.peerClient.sendData(data);\n  }\n\n  on(event, callback) {\n    this.peerClient.setEventCallback(event, callback);\n  }\n\n  close() {\n    this.peerClient.terminateSession();\n  }\n}\n\nexport { SimplePeerWrapper }\n//module.exports = SimplePeerWrapper;\n"],"names":["debug","require","getBrowserRTC","randombytes","stream","queueMicrotask","errCode","Buffer","MAX_BUFFERED_AMOUNT","ICECOMPLETE_TIMEOUT","CHANNEL_CLOSING_TIMEOUT","filterTrickle","sdp","replace","warn","message","console","Peer","opts","Object","assign","allowHalfOpen","_id","toString","slice","_debug","channelName","initiator","channelConfig","channelNegotiated","negotiated","config","offerOptions","answerOptions","sdpTransform","streams","trickle","undefined","allowHalfTrickle","iceCompleteTimeout","destroyed","destroying","_connected","remoteAddress","remoteFamily","remotePort","localAddress","localFamily","localPort","_wrtc","wrtc","window","Error","_pcReady","_channelReady","_iceComplete","_iceCompleteTimer","_channel","_pendingCandidates","_isNegotiating","_firstNegotiation","_batchedNegotiation","_queuedNegotiation","_sendersAwaitingStable","_senderMap","Map","_closingInterval","_remoteTracks","_remoteStreams","_chunk","_cb","_interval","_pc","RTCPeerConnection","err","destroy","_isReactNativeWebrtc","_peerConnectionId","oniceconnectionstatechange","_onIceStateChange","onicegatheringstatechange","onconnectionstatechange","_onConnectionStateChange","onsignalingstatechange","_onSignalingStateChange","onicecandidate","event","_onIceCandidate","peerIdentity","_setupData","channel","createDataChannel","ondatachannel","forEach","addStream","ontrack","_onTrack","_needsNegotiation","_onFinishBound","_onFinish","once","bufferedAmount","readyState","port","family","address","data","JSON","parse","renegotiate","transceiverRequest","addTransceiver","kind","init","candidate","remoteDescription","type","_addIceCandidate","push","setRemoteDescription","RTCSessionDescription","then","_createAnswer","iceCandidateObj","RTCIceCandidate","addIceCandidate","endsWith","chunk","send","emit","getTracks","track","addTrack","submap","get","sender","set","removed","oldTrack","newTrack","replaceTrack","removeTrack","name","negotiate","setTimeout","_createOffer","_destroy","cb","readable","writable","_readableState","ended","_writableState","finished","end","clearInterval","removeListener","close","onmessage","onopen","onclose","onerror","binaryType","bufferedAmountLowThreshold","label","_onChannelMessage","onbufferedamountlow","_onChannelBufferedAmountLow","_onChannelOpen","_onChannelClose","error","filename","lineno","colno","isClosing","setInterval","encoding","destroySoon","createOffer","offer","sendOffer","signal","localDescription","onSuccess","onError","setLocalDescription","getTransceivers","transceiver","mid","requested","createAnswer","answer","sendAnswer","_requestMissingTransceivers","connectionState","iceConnectionState","iceGatheringState","_maybeReady","flattenValues","report","prototype","call","values","value","getStats","length","res","reports","result","names","stat","id","timestamp","_connecting","findCandidatePair","items","remoteCandidates","localCandidates","candidatePairs","foundSelectedCandidatePair","item","setSelectedCandidatePair","selectedCandidatePair","local","localCandidateId","ip","Number","ipAddress","portNumber","googLocalAddress","split","includes","remote","remoteCandidateId","googRemoteAddress","selectedCandidatePairId","googActiveConnection","selected","keys","_onInterval","unref","signalingState","sdpMLineIndex","sdpMid","_startIceCompleteTimeout","ArrayBuffer","from","eventStream","some","remoteStream","args","arguments","apply","Duplex","WEBRTC_SUPPORT","iceServers","urls","sdpSemantics","SimplePeerClientWrapper","socket","simplePeerOptions","initPeerRequest","localStream","connections","onDataCallback","onStreamCallback","onCloseCallback","onErrorCallback","log","i","room","attemptPeerStart","connection","peerStarted","roomReady","createPeerConnection","options","_getPeerOptions","peer","on","_sendSignal","_handleConnection","_handleError","_handleStream","_handleData","_handleClose","callback","msg","stringify","userId","peerConn","connected","write","spOptions","entries","key","decodedString","TextDecoder","decode","decodedJSON","terminateSession","io","SocketIOClientWrapper","serverUrl","connect","peerClient","setlocalStream","_initSocket","_handleCreated","_handleFullRoom","_handleJoinRoom","_handleJoinedRoom","_handleInitPeer","_handleSendSignal","array","_handleLog","_handleMessage","_startSocketCommunication","_logConnection","_room","_initiator","_roomReady","_peerStarted","newConnection","_findConnection","SimplePeerWrapper","socketClient","isPeerStarted","sendData","setEventCallback"],"mappings":"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"}